<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: ConfigParser</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">ConfigParser</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/lib/config_parser_rb.html">
                lib/config_parser.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
This class based on ParseConfig gem (Author is BJ Dierkes
&lt;wdierkes@5dollarwhitebox.org&gt;) This class was written to simplify
the parsing of configuration files in the format of &quot;param =
value&quot;.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000011">get_params_keys</a>&nbsp;&nbsp;
      <a href="#M000008">get_value</a>&nbsp;&nbsp;
      <a href="#M000007">new</a>&nbsp;&nbsp;
      <a href="#M000010">nil_value</a>&nbsp;&nbsp;
      <a href="#M000009">override_value</a>&nbsp;&nbsp;
      <a href="#M000014">parse_from_file</a>&nbsp;&nbsp;
      <a href="#M000013">parse_setting</a>&nbsp;&nbsp;
      <a href="#M000015">set_var_from</a>&nbsp;&nbsp;
      <a href="#M000012">try_convert_value</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">params</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000007" class="method-detail">
        <a name="M000007"></a>

        <div class="method-heading">
          <a href="#M000007" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(config_files=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Initialize the class with the path to the &#8216;config_file&#8217; The
class objects are dynamically generated by the name of the
&#8216;param&#8217; in the config file. Therefore, if the config file is
&#8216;param = value&#8217; then the itializer will eval &quot;@param =
value&quot; if config_file not defined then remember settings from command
line command line argument should be in pattern
&lt;opts=&quot;settings_name_a=value_a, settings_name_b=value_b,
&#8230;&quot;&gt;
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000007-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000007-source">
<pre>
<span class="ruby-comment cmt"># File lib/config_parser.rb, line 16</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">config_files</span>=<span class="ruby-keyword kw">nil</span>)
    <span class="ruby-ivar">@params</span> = {}
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">config_files</span>
      <span class="ruby-identifier">config_files</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span> <span class="ruby-identifier">parse_from_file</span>(<span class="ruby-identifier">file</span>)}
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-identifier">opts</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'OPTS'</span>] 
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span> <span class="ruby-keyword kw">and</span> (<span class="ruby-keyword kw">not</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">empty?</span>)
        <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">opt_line</span><span class="ruby-operator">|</span> <span class="ruby-identifier">set_var_from</span>(<span class="ruby-identifier">opt_line</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt_line</span> }
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000011" class="method-detail">
        <a name="M000011"></a>

        <div class="method-heading">
          <a href="#M000011" class="method-signature">
          <span class="method-name">get_params_keys</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
return all defined settings&#8217; names for this instance
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000011-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000011-source">
<pre>
<span class="ruby-comment cmt"># File lib/config_parser.rb, line 51</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_params_keys</span>()
    <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">params</span>.<span class="ruby-identifier">keys</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000008" class="method-detail">
        <a name="M000008"></a>

        <div class="method-heading">
          <a href="#M000008" class="method-signature">
          <span class="method-name">get_value</span><span class="method-args">(param)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method will provide the value held by the object &quot;@param&quot;
where &quot;@param&quot; is actually the name of the param in the config
file.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000008-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000008-source">
<pre>
<span class="ruby-comment cmt"># File lib/config_parser.rb, line 32</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_value</span>(<span class="ruby-identifier">param</span>)
    <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-node">&quot;@#{param}&quot;</span>)
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000010" class="method-detail">
        <a name="M000010"></a>

        <div class="method-heading">
          <a href="#M000010" class="method-signature">
          <span class="method-name">nil_value</span><span class="method-args">(param)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method will set the value of &#8217;@param&#8217; to nil (not in the
config file, only in the app).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000010-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000010-source">
<pre>
<span class="ruby-comment cmt"># File lib/config_parser.rb, line 46</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nil_value</span>(<span class="ruby-identifier">param</span>)
    <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-node">&quot;@#{param}&quot;</span>, <span class="ruby-keyword kw">nil</span>)
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000009" class="method-detail">
        <a name="M000009"></a>

        <div class="method-heading">
          <a href="#M000009" class="method-signature">
          <span class="method-name">override_value</span><span class="method-args">(param, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method is simple. Should you need to override a value dynamically, use
<a href="ConfigParser.html#M000009">override_value</a>(param, value) where
&#8216;param&#8217; is the name of the paramater in the config file.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000009-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000009-source">
<pre>
<span class="ruby-comment cmt"># File lib/config_parser.rb, line 40</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">override_value</span>(<span class="ruby-identifier">param</span>, <span class="ruby-identifier">value</span>)
    <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-node">&quot;@#{param}&quot;</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">
          <a href="#M000014" class="method-signature">
          <span class="method-name">parse_from_file</span><span class="method-args">(config_file)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
parse settings file. Raise exception if file does not exist if line starts
with &quot;#&quot; symbol line ignores
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000014-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000014-source">
<pre>
<span class="ruby-comment cmt"># File lib/config_parser.rb, line 94</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_from_file</span>(<span class="ruby-identifier">config_file</span>)
    <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">readable?</span>(<span class="ruby-identifier">config_file</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EACCES</span>, <span class="ruby-node">&quot;#{config_file} is not readable&quot;</span>
    <span class="ruby-keyword kw">end</span>
    
    <span class="ruby-identifier">open</span>(<span class="ruby-identifier">config_file</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">line</span>.<span class="ruby-identifier">strip!</span>
      <span class="ruby-keyword kw">unless</span> (<span class="ruby-regexp re">/^\#/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">line</span>))
        <span class="ruby-identifier">set_var_from</span>(<span class="ruby-identifier">line</span>) <span class="ruby-keyword kw">if</span>  (<span class="ruby-regexp re">/\s*=\s*/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">line</span>))
      <span class="ruby-keyword kw">end</span>
    }
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="#M000013" class="method-signature">
          <span class="method-name">parse_setting</span><span class="method-args">(line)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
try parse setting&#8216;s line delimiter is &quot;=&quot;, ignores single
and double quotes in the start and end positions
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000013-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000013-source">
<pre>
<span class="ruby-comment cmt"># File lib/config_parser.rb, line 79</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_setting</span>(<span class="ruby-identifier">line</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Invalid pair: #{line}. Expected: name=value&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">line</span>[<span class="ruby-value str">&quot;=&quot;</span>]
    <span class="ruby-identifier">param</span>, <span class="ruby-identifier">value</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\s*=\s*/</span>, <span class="ruby-value">2</span>)
    <span class="ruby-identifier">var_name</span> = <span class="ruby-identifier">param</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span>
    <span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">strip</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>
    <span class="ruby-identifier">new_value</span> = <span class="ruby-value str">''</span>
    <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">value</span>)
     <span class="ruby-identifier">new_value</span> = (<span class="ruby-identifier">value</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^[&quot;](.*)[&quot;]$/</span>) <span class="ruby-operator">?</span>  <span class="ruby-identifier">$1</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">value</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">new_value</span> = <span class="ruby-identifier">try_convert_value</span>(<span class="ruby-identifier">new_value</span>)
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">var_name</span>, <span class="ruby-identifier">new_value</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">
          <a href="#M000015" class="method-signature">
          <span class="method-name">set_var_from</span><span class="method-args">(line)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000015-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000015-source">
<pre>
<span class="ruby-comment cmt"># File lib/config_parser.rb, line 107</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_var_from</span>(<span class="ruby-identifier">line</span>)
    <span class="ruby-identifier">var_name</span>, <span class="ruby-identifier">new_value</span> = <span class="ruby-identifier">parse_setting</span>(<span class="ruby-identifier">line</span>)
    <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-node">&quot;@#{var_name}&quot;</span>, <span class="ruby-identifier">new_value</span>)
    <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">params</span>[<span class="ruby-node">&quot;#{var_name}&quot;</span>] = <span class="ruby-identifier">new_value</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="#M000012" class="method-signature">
          <span class="method-name">try_convert_value</span><span class="method-args">(value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Try to convert value from string to other types (int, boolean, float)
return value as String if all of tries were failed If value is not String,
return it as is.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000012-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000012-source">
<pre>
<span class="ruby-comment cmt"># File lib/config_parser.rb, line 58</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_convert_value</span>(<span class="ruby-identifier">value</span>)
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^[0-9]+$/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">value</span>) <span class="ruby-comment cmt">#int</span>
        <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_i</span>
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-regexp re">/^[0-9]+(\.)[0-9]*$/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">value</span>) <span class="ruby-comment cmt">#float</span>
        <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_f</span>
      <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">value</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;true&quot;</span>) <span class="ruby-comment cmt">#boolean</span>
        <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
      <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">value</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;false&quot;</span>) <span class="ruby-comment cmt">#boolean</span>
        <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">value</span> <span class="ruby-comment cmt"># can't parse, return String</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">else</span> <span class="ruby-comment cmt"># value is not String, return it as is</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">value</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>